<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8" />
    <title>Legal Contract Analyzer</title>
    <link rel="stylesheet" href="{{ url_for('static', filename='style.css') }}">
</head>
<body>
    <div class="container">
        <h1>ğŸ“„ Legal Contract Analyzer</h1>
        <p>Upload a contract PDF and receive a detailed summary via email.</p>

        <form id="uploadForm">
            <label>Email Address</label>
            <input type="email" name="user_email" required placeholder="you@example.com">

            <label>Contract File (PDF)</label>
            <input type="file" name="contract" accept=".pdf" required>

            <button type="submit">Analyze Contract</button>
        </form>
    </div>

    <!-- Loading overlay -->
    <div id="loading" class="loading hidden">
        <div class="spinner"></div>
        <p>Analyzing your contract... This may take a minute â³</p>
    </div>

    <!-- Toast notification -->
    <div id="toast" class="toast hidden"></div>

    <script>
        const form = document.getElementById('uploadForm');
        const loading = document.getElementById('loading');
        const toast = document.getElementById('toast');

        form.addEventListener('submit', async (e) => {
            e.preventDefault();
            loading.classList.remove('hidden');

            const formData = new FormData(form);

            try {
                const response = await fetch('/upload', {
                    method: 'POST',
                    body: formData
                });

                const data = await response.json();
                loading.classList.add('hidden');

                showToast(data.message, data.success ? 'success' : 'error');
            } catch (err) {
                loading.classList.add('hidden');
                showToast('Something went wrong. Please try again.', 'error');
            }
        });

        function showToast(message, type) {
            toast.textContent = message;
            toast.className = `toast ${type}`;
            setTimeout(() => {
                toast.classList.add('hidden');
            }, 6000);
        }
    </script>
</body>
</html>
